# Data Structures for File Analyzer Project

This document describes the main data structures generated by `directory_analyzer.py` and passed to other modules like `report_generator.py` and `plot_generator.py`.

## 1. `all_files_data`

This is a **list of dictionaries**. Each dictionary represents a "file-like" entry found by `os.walk` in the `files` list during the directory traversal. This includes regular files and symbolic links that point to files (or are broken/point to non-files but were listed in `files`).

Each dictionary (representing one file entry) contains the following keys:

*   `'path'`: (`pathlib.Path` object) The full absolute path to the file entry.
*   `'name'`: (string) The name of the file entry (e.g., `document.txt`).
*   `'is_symlink'`: (boolean) `True` if this entry is a symbolic link (identified by `path.is_symlink()`), `False` otherwise.
*   `'is_hidden'`: (boolean) `True` if this entry is considered hidden according to OS conventions (leading dot on Linux, hidden attribute on Windows), `False` otherwise.
*   `'size_bytes'`: (integer)
    *   For regular files: The size of the file in bytes (from `lstat().st_size`).
    *   For symbolic links: The size of the symbolic link file *itself* in bytes (i.e., the length of the target path string on Linux, often 0 on Windows for `mklink` file symlinks). This is from `lstat().st_size`.
*   `'type'`: (string) The determined type of the entry.
    *   For regular files: The file extension in lowercase (e.g., `.txt`, `.pdf`). If no extension, it's `config.NO_EXTENSION_STR` (e.g., `.<no_ext>`).
    *   For symbolic links (to files): A special string like `config.SYMLINK_TYPE_STR` (e.g., `.<symlink>`), `config.BROKEN_SYMLINK_TYPE_STR`, `config.SYMLINK_TO_DIR_TYPE_STR` (if a symlink in the `files` list surprisingly points to a dir), or `config.SYMLINK_ERROR_TYPE_STR`.
    *   For non-regular files found in `os.walk`'s `files` list: `config.NON_FILE_TYPE_STR`.
    *   If an error occurred processing the entry: `config.ERROR_TYPE_STR`.
*   `'symlink_target_path'`: (`pathlib.Path` object or string)
    *   If `is_symlink` is `True`: The absolute path to the *immediate target* of the symbolic link.
    *   If `is_symlink` is `False`: `None`.
    *   Can be a string like "Error reading link..." if `os.readlink` failed.
*   `'symlink_target_type'`: (string)
    *   If `is_symlink` is `True` and the target could be assessed: The file extension of the target (e.g., `.txt`), or `.<dir>` if target is a directory, or `.<broken>` if target doesn't exist, or `.<special_target>` for other target types.
    *   If `is_symlink` is `False` or target couldn't be assessed: `None`.
*   `'symlink_target_size_bytes'`: (integer)
    *   If `is_symlink` is `True` and the target is a file whose stats could be read: The size of the target file in bytes.
    *   Otherwise: `None`.

**Example `all_files_data` element:**
```python
{
    'path': pathlib.PosixPath('/home/user/docs/report.pdf'),
    'name': 'report.pdf',
    'is_symlink': False,
    'is_hidden': False,
    'size_bytes': 102400, # 100 KB
    'type': '.pdf',
    'symlink_target_path': None,
    'symlink_target_type': None,
    'symlink_target_size_bytes': None
}
```
```python
{
    'path': pathlib.PosixPath('/home/user/links/my_doc_link.txt'),
    'name': 'my_doc_link.txt',
    'is_symlink': True,
    'is_hidden': False,
    'size_bytes': 25, # Length of "../actual_docs/document.txt"
    'type': '.<symlink>', # Assuming config.SYMLINK_TYPE_STR is ".<symlink>"
    'symlink_target_path': pathlib.PosixPath('/home/user/actual_docs/document.txt'),
    'symlink_target_type': '.txt',
    'symlink_target_size_bytes': 51200
}
```

## 2. `directory_symlinks_data`

This is a **list of dictionaries**, similar to `all_files_data`, but specifically for symbolic links that were identified in the `dirs` list of `os.walk` (i.e., they are expected to point to directories).

Each dictionary contains the following keys:

*   `'path'`: (`pathlib.Path` object) The full absolute path to the directory symbolic link.
*   `'name'`: (string) The name of the directory symbolic link.
*   `'is_symlink'`: (boolean) Always `True` for entries in this list.
*   `'is_hidden'`: (boolean) `True` if the directory symlink itself is hidden (e.g., `.my_dir_link`), `False` otherwise.
*   `'size_bytes'`: (integer) The size of the directory symbolic link file *itself* (from `lstat().st_size`).
*   `'type'`: (string) A special string indicating it's a symlink to a directory, e.g., `config.SYMLINK_TO_DIR_TYPE_STR` (like `.<symlink_to_dir>`), or `config.BROKEN_SYMLINK_TYPE_STR` if broken, or `config.SYMLINK_ERROR_TYPE_STR`.
*   `'symlink_target_path'`: (`pathlib.Path` object or string) The absolute path to the *immediate target* of the symbolic link.
*   `'symlink_target_type'`: (string) Typically `.<dir>` if the target exists and is a directory, `.<broken>` if not, or `.<target_not_dir>` if it points to something else unexpectedly.

**Example `directory_symlinks_data` element:**
```python
{
    'path': pathlib.PosixPath('/home/user/shortcuts/config_dir_link'),
    'name': 'config_dir_link',
    'is_symlink': True,
    'is_hidden': False,
    'size_bytes': 15, # Length of "../.config"
    'type': '.<symlink_to_dir>', # Assuming config.SYMLINK_TO_DIR_TYPE_STR
    'symlink_target_path': pathlib.PosixPath('/home/user/.config'),
    'symlink_target_type': '.<dir>'
}
```

## 3. `summary_data`

This is a **dictionary** containing aggregated statistics from the analysis. While less direct for plotting individual files, some parts might be useful for plot annotations or overall context.

Key fields include:

*   `'target_directory'`: (string) The absolute path of the directory that was analyzed.
*   `'total_directories_scanned'`: (integer)
*   `'total_file_entries_processed'`: (integer) Count of items from `os.walk`'s `files` list.
*   `'total_directory_symlinks_found'`: (integer) Count of items from `os.walk`'s `dirs` list identified as symlinks.
*   `'skipped_access_errors'`: (integer)
*   `'file_types_summary'`: (dictionary) Keys are file types/extensions (strings like `'.txt'`, `.<symlink>`), values are counts (integer). Sorted by count descending.
*   `'file_types_size_summary'`: (dictionary) Keys are file types/extensions, values are total size in bytes for that type.
*   `'total_hidden_files_count'`: (integer) Total count of items marked as hidden.
*   `'total_hidden_files_size'`: (integer) Total size of items marked as hidden (using their `size_bytes`).
*   `'hidden_file_types_summary'`: (dictionary) Like `file_types_summary` but only for hidden items. Sorted by count descending.
*   `'hidden_file_types_size_summary'`: (dictionary) Like `file_types_size_summary` but only for hidden items.